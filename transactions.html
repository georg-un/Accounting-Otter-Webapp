<!DOCTYPE html>
<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular-resource.js"></script>
    <script language="javascript">
        let urlParams = new URLSearchParams(window.location.search);
        let start = urlParams.get('start');
        let end = urlParams.get('end');
        if (start == null) {
            start = 0;
        }
        if (end == null) {
            end = 15;
        }
        let targetUrl = 'http://localhost:8080/api/v1/transactions'.concat('?start=', start, "&end=", end);
        angular.module('GetRestObject', ['ngResource']);
        function Ctrl($scope, $resource) {
            let restservice = $resource(
                targetUrl, {}, {
                    query: {method: 'GET', isArray: true}
                }
            );
            $scope.transactions = restservice.query();
            console.log($scope.transactions);

            $scope.splitAtComma = function(int) {
                return int.toFixed(2).toString().split('.');
            };
        }

    </script>
</head>
<title>Accounting Otter</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="css/materialize.min.css" type="text/css" media="screen,projection"/>
<body>

    <div>
        <!-- navbar -->
        <nav class="z-depth-3" style="position:fixed; top:0; z-index: 5000">
            <div class="nav-wrapper blue-theme">
                <a href="#" class="brand-logo center"><img src="images/otter-icon-64.png"/></a>
                <div class="left">
                    <a href="#" data-target="slide-out" class="sidenav-trigger"><i class="material-icons">menu</i></a>
                </div>
            </div>
        </nav>
        <!-- sidebar -->
        <ul id="slide-out" class="sidenav" style="z-index: 6000">
            <li><div class="user-view">
                <div class="background">
                    <img src="images/tmp/tmp-background.jpg">
                </div>
                <a href="#user"><img class="circle" src="images/tmp/otter-avatar.jpg"></a>
                <a href="#name"><span class="white-text name">Sea Otter</span></a>
                <a href="#email"><span class="white-text email">give_me_fish@accounting-otter.com</span></a>
            </div></li>
            <li><a class="waves-effect" href="overview.html"><i class="material-icons">people</i>Overview</a></li>
            <li><a class="waves-effect" href="#!"><i class="material-icons">list</i>Transactions</a></li>
            <br/><br/>
            <li><div class="divider"></div></li>
            <br/>
            <li><a class="waves-effect" href="#!">Settings</a></li>
            <li><a class="waves-effect" href="#!">Logout</a></li>
        </ul>
        <!-- card-containes -->
        <div class="transaction-card-conatainer">
            <div ng-app="GetRestObject" ng-controller="Ctrl">
                <div ng-repeat="transaction in transactions">
                    <a ng-href='payment.html?id={{transaction.transactionId}}'>
                        <div class="transaction-grid-card z-depth-1 hoverable">
                            <div class="transaction-card-avatar valign-wrapper">
                                <img class="circle avatar" src="images/tmp/otter-avatar.jpg">
                            </div>
                            <div class="transaction-card-date transaction-card-first-row">
                                <p style="color:black;">{{transaction.description}}</p>
                            </div>
                            <div class="transaction-card-shop">
                                <p class="x-large" style="color:black;"><b>{{transaction.shop}}</b><p>
                            </div>
                            <div class="transaction-card-category transaction-card-last-row">
                                <p style="color:black;">{{transaction.category}}</p>
                            </div>
                            <div class="transaction-card-amount" style="text-align:right;">
                                <p class="x-large" style="color:black;  display:inline;">
                                    {{splitAtComma(transaction.sumAmount)[0]}},
                                </p>
                                <p style="color:black; display:inline;">
                                    {{splitAtComma(transaction.sumAmount)[1]}}
                                </p>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
            <!-- add button -->
            <a class="btn-floating btn-large waves-effect waves-light red hover-button2 z-depth-3" href="payment-editor.html">
                <i class="material-icons">add</i>
            </a>
        </div>
    </div>

    <script type="text/javascript" src="js/materialize.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var elems = document.querySelectorAll('.sidenav');
            var instances = M.Sidenav.init(elems, edge="left", draggable=true);
        });
    </script>
</body>
</html> 

