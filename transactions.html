<!DOCTYPE html>
<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular-resource.js"></script>
    <script language="javascript">
        let urlParams = new URLSearchParams(window.location.search);
        let start = urlParams.get('start');
        let end = urlParams.get('end');
        if (start == null) {
            start = 0;
        }
        if (end == null) {
            end = 15;
        }
        let targetUrl = 'http://localhost:8080/api/v1/transactions'.concat('?start=', start, "&end=", end);
        angular.module('GetRestObject', ['ngResource']);
        function Ctrl($scope, $resource) {
            let restservice = $resource(
                targetUrl, {}, {
                    query: {method: 'GET', isArray: true}
                }
            );
            $scope.transactions = restservice.query();
            console.log($scope.transactions);

            $scope.splitAtComma = function(int) {
                return int.toFixed(2).toString().split('.');
            };
        }

    </script>
</head>
<title>Accounting Otter</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="css/materialize.min.css" type="text/css" media="screen,projection"/>
<body>

<!--div class="w3-overlay w3-hide-large w3-animate-opacity"
     onclick="w3_close()" style="cursor:pointer" id="myOverlay"></div-->

    <div>
        <nav class="z-depth-3" style="position:fixed; top:0;">
            <div class="nav-wrapper blue-theme">
                <a href="#" class="brand-logo center"><img src="graphics/otter-icon-64.png"/></a>
                <div class="left">
                    <a href='transactions.html' class="btn-large blue-theme" style="box-shadow: none">
                        <i class="material-icons">menu</i>
                    </a>
                </div>
            </div>
        </nav>
        <div class="card-conatainer">
            <div ng-app="GetRestObject" ng-controller="Ctrl">
                <div ng-repeat="transaction in transactions">
                    <a ng-href='payment.html?id={{transaction.transactionId}}'>
                        <div class="transaction-grid-card z-depth-1">
                            <div class="card-avatar valign-wrapper">
                                <i class="material-icons icon-black">person</i>
                            </div>
                            <div class="card-date card-first-row">
                                <p style="color:black;">{{transaction.description}}</p>
                            </div>
                            <div class="card-shop">
                                <p class="x-large" style="color:black;"><b>{{transaction.shop}}</b><p>
                            </div>
                            <div class="card-category card-last-row">
                                <p style="color:black;">{{transaction.category}}</p>
                            </div>
                            <div class="card-amount" style="text-align:right;">
                                <p class="x-large" style="color:black;  display:inline;">
                                    {{splitAtComma(transaction.sumAmount)[0]}},
                                </p>
                                <p style="color:black; display:inline;">

                                    {{splitAtComma(transaction.sumAmount)[1]}}

                                </p>
                            </div>
                        </div>
                    </a>
                    <!--hr/-->
                </div>
            </div>
            <a class="btn-floating btn-large waves-effect waves-light red hover-button2 z-depth-3">
                <i class="material-icons">add</i>
            </a>
        </div>
    </div>


</body>
</html> 

